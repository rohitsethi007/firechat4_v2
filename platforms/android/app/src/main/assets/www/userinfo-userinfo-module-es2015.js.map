{"version":3,"sources":["./src/app/userinfo/userinfo.page.html","./src/app/userinfo/userinfo.module.ts","./src/app/userinfo/userinfo.page.scss","./src/app/userinfo/userinfo.page.ts"],"names":[],"mappings":"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","file":"userinfo-userinfo-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title *ngIf=\\\"user\\\">{{user.name}}</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <div *ngIf=\\\"user\\\">\\n    <ion-row padding> \\n    <div class=\\\"user-info\\\">\\n      <div class=\\\"user-img\\\">\\n        <img src=\\\"{{user.img}}\\\">\\n      </div>\\n\\n    <img src=\\\"{{user.img}}\\\" (click)=\\\"enlargeImage(user.img)\\\" onError=\\\"this.src='./assets/images/default-dp.png'\\\">\\n    <h4 style=\\\"margin:0\\\">{{user.name}}</h4>\\n    <p style=\\\"color:#aaa;margin:0\\\">@{{user.username}}</p>\\n    <p style=\\\"color:#444\\\">{{user.description}}</p>\\n    <div style=\\\"border-top: 1px solid #ececec; padding: 10px;\\\">\\n      <!-- Show actions based on the status of the user in relation to the current logged in user. -->\\n      <div *ngIf=\\\"friendRequests && friendRequests.indexOf(user.$key) > -1\\\">\\n        <p class=\\\"info\\\">Sent you a friend request.</p>\\n        <ion-button size=\\\"small\\\" (click)=\\\"rejectFriendRequest()\\\">\\n          Decline\\n        </ion-button>\\n        <ion-button size=\\\"small\\\" (click)=\\\"acceptFriendRequest()\\\">\\n          Accept\\n        </ion-button>\\n      </div>\\n      <div *ngIf=\\\"requestsSent && requestsSent.indexOf(user.$key) > -1\\\">\\n        <ion-button size=\\\"small\\\" (click)=\\\"cancelFriendRequest()\\\">Cancel\\n          Request</ion-button>\\n      </div>\\n      <div *ngIf=\\\"canAdd()\\\">\\n        <ion-button size=\\\"small\\\" (click)=\\\"sendFriendRequest()\\\">Add Friend</ion-button>\\n      </div>\\n      <div *ngIf=\\\"friends && friends.indexOf(user.$key) > -1\\\">\\n        <ion-button size=\\\"small\\\" (click)=\\\"sendMessage()\\\">Start Chat</ion-button>\\n        <ion-button size=\\\"small\\\" (click)=\\\"block()\\\">Block User</ion-button>\\n      </div>\\n    </div>\\n\\n\\n  </div>\\n  </ion-row>\\n  </div>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { UserinfoPage } from './userinfo.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserinfoPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [UserinfoPage]\n})\nexport class UserinfoPageModule {}\n","export default \":host {\\n  --page-margin: var(--app-narrow-margin);\\n  --page-background: var(--app-background);\\n}\\n\\n.user-info {\\n  margin: var(--page-margin) var(--page-margin) var(--page-margin) var(--page-margin);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdXNlcmluZm8vdXNlcmluZm8ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksdUNBQUE7RUFDQSx3Q0FBQTtBQUNKOztBQUVBO0VBQ0ksbUZBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL3VzZXJpbmZvL3VzZXJpbmZvLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcbiAgICAtLXBhZ2UtbWFyZ2luOiB2YXIoLS1hcHAtbmFycm93LW1hcmdpbik7XG4gICAgLS1wYWdlLWJhY2tncm91bmQ6IHZhcigtLWFwcC1iYWNrZ3JvdW5kKTtcbiAgfVxuXG4udXNlci1pbmZvIHtcbiAgICBtYXJnaW46IHZhcigtLXBhZ2UtbWFyZ2luKSB2YXIoLS1wYWdlLW1hcmdpbikgdmFyKC0tcGFnZS1tYXJnaW4pIHZhcigtLXBhZ2UtbWFyZ2luKTtcbiAgICAudXNlci1pbWcge1xuICBcbiAgICB9XG59Il19 */\";","import { Component, OnInit } from '@angular/core';\nimport { DataService } from '../services/data.service';\nimport { LoadingService } from '../services/loading.service';\nimport { AlertController, ModalController } from '@ionic/angular';\nimport { FirebaseService } from '../services/firebase.service';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport * as firebase from 'firebase';\n\n@Component({\n  selector: 'app-userinfo',\n  templateUrl: './userinfo.page.html',\n  styleUrls: ['./userinfo.page.scss'],\n})\nexport class UserinfoPage implements OnInit {\n\n\n  user: any;\n  userId: any;\n  friendRequests: any;\n  requestsSent: any;\n  friends: any;\n  alert: any;\n  // UserInfoPage\n  // This is the page where the user can view user information, and do appropriate actions based on their relation to the current logged in user.\n  constructor(\n    // public navCtrl: NavController,\n    // public navParams: NavParams,\n    private router: Router,\n    public modalCtrl: ModalController,\n    public dataProvider: DataService,\n    public loadingProvider: LoadingService,\n    public alertCtrl: AlertController,\n    public firebaseProvider: FirebaseService,\n    private route: ActivatedRoute\n  ) { }\n\n  ngOnInit() {\n  }\n\n  ionViewDidEnter() {\n    // this.userId = this.navParams.get('userId');\n    this.userId = this.route.snapshot.params.id;\n    console.log(this.userId);\n    this.loadingProvider.show();\n    // Get user info.\n    this.dataProvider.getUser(this.userId).snapshotChanges().subscribe((user: any) => {\n      this.user = { $key: user.key, ...user.payload.data() };\n      console.log(this.user);\n      this.loadingProvider.hide();\n    });\n    // Get friends of current logged in user.\n    this.dataProvider.getUser(firebase.auth().currentUser.uid).snapshotChanges().subscribe((user: any) => {\n      if (user.payload.data() != null)\n        this.friends = user.payload.data().friends;\n    });\n    // Get requests of current logged in user.\n    this.dataProvider.getRequests(firebase.auth().currentUser.uid).snapshotChanges().subscribe(((requests: any) => {\n      console.log(requests.payload.data())\n      if (requests.payload.data() != null) {\n        this.friendRequests = requests.payload.data().friendRequests;\n        this.requestsSent = requests.payload.data().requestsSent;\n      }\n    }));\n  }\n\n  block() {\n    this.loadingProvider.show();\n    console.log(\"block function\");\n    firebase.database().ref('accounts/' + firebase.auth().currentUser.uid + '/conversations/' + this.userId).update({\n      blocked: true\n    }).then(() => {\n      this.loadingProvider.hide();\n      this.loadingProvider.showToast(\"User Blocked\");\n      this.router.navigateByUrl('/');\n    }).catch(() => {\n      this.loadingProvider.hide();\n      this.loadingProvider.showToast(\"Something went wrong\");\n    });\n\n  }\n\n  // Enlarge user's profile image.\n  enlargeImage(img) {\n    // let imageModal = this.modalCtrl.create(\"ImageModalPage\", { img: img });\n    // imageModal.present();\n  }\n\n  // Accept friend request.\n  acceptFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Confirm Friend Request',\n      message: 'Do you want to accept <b>' + this.user.name + '</b> as your friend?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Accept',\n          handler: () => {\n            this.firebaseProvider.acceptFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Deny friend request.\n  rejectFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Reject Friend Request',\n      message: 'Do you want to reject <b>' + this.user.name + '</b> as your friend?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Reject',\n          handler: () => {\n            this.firebaseProvider.deleteFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Cancel friend request sent.\n  cancelFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Friend Request Pending',\n      message: 'Do you want to delete your friend request to <b>' + this.user.name + '</b>?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Delete',\n          handler: () => {\n            this.firebaseProvider.cancelFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Send friend request.\n  sendFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Send Friend Request',\n      message: 'Do you want to send friend request to <b>' + this.user.name + '</b>?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Send',\n          handler: () => {\n            this.firebaseProvider.sendFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Open chat with this user.\n  sendMessage() {\n    this.router.navigateByUrl('/message/' + this.userId);\n    // this.navCtrl.push(MessagePage, { userId: this.userId });\n  }\n\n  // Check if user can be added, meaning user is not yet friends nor has sent/received any friend requests.\n  canAdd() {\n    if (this.friendRequests) {\n      if (this.friendRequests.indexOf(this.userId) > -1) {\n        return false;\n      }\n    }\n    if (this.requestsSent) {\n      if (this.requestsSent.indexOf(this.userId) > -1) {\n        return false;\n      }\n    }\n    if (this.friends) {\n      if (this.friends.indexOf(this.userId) > -1) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n}\n"],"sourceRoot":"webpack:///"}