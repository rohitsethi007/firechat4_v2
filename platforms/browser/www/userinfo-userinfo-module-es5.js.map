{"version":3,"sources":["src/app/userinfo/userinfo.page.html","src/app/userinfo/userinfo.module.ts","src/app/userinfo/userinfo.page.scss","src/app/userinfo/userinfo.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title *ngIf=\\\"user\\\">{{user.name}}</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <div *ngIf=\\\"user\\\"\\n    style=\\\"display:flex; flex-direction: column; justify-content: center; height: 100%; align-items: center;\\\">\\n    <img src=\\\"{{user.img}}\\\" (click)=\\\"enlargeImage(user.img)\\\" onError=\\\"this.src='./assets/images/default-dp.png'\\\"\\n      style=\\\"border-radius: 100%; height: 80px; width: 80px;\\\">\\n    <h4 style=\\\"margin:0\\\">{{user.name}}</h4>\\n    <p style=\\\"color:#aaa;margin:0\\\">@{{user.username}}</p>\\n    <p style=\\\"color:#444\\\">{{user.description}}</p>\\n    <div style=\\\"border-top: 1px solid #ececec; padding: 10px;\\\">\\n      <!-- Show actions based on the status of the user in relation to the current logged in user. -->\\n      <div *ngIf=\\\"friendRequests && friendRequests.indexOf(user.$key) > -1\\\">\\n        <p class=\\\"info\\\">Sent you a friend request.</p>\\n        <ion-button size=\\\"small\\\" (click)=\\\"rejectFriendRequest()\\\">\\n          Decline\\n        </ion-button>\\n        <ion-button size=\\\"small\\\" (click)=\\\"acceptFriendRequest()\\\">\\n          Accept\\n        </ion-button>\\n      </div>\\n      <div *ngIf=\\\"requestsSent && requestsSent.indexOf(user.$key) > -1\\\">\\n        <ion-button size=\\\"small\\\" (click)=\\\"cancelFriendRequest()\\\">Cancel\\n          Request</ion-button>\\n      </div>\\n      <div *ngIf=\\\"canAdd()\\\">\\n        <ion-button size=\\\"small\\\" (click)=\\\"sendFriendRequest()\\\">Add Friend</ion-button>\\n      </div>\\n      <div *ngIf=\\\"friends && friends.indexOf(user.$key) > -1\\\">\\n        <ion-button size=\\\"small\\\" (click)=\\\"sendMessage()\\\">Start Chat</ion-button>\\n        <ion-button size=\\\"small\\\" (click)=\\\"block()\\\">Block User</ion-button>\\n      </div>\\n    </div>\\n\\n\\n  </div>\\n</ion-content>\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { UserinfoPage } from './userinfo.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserinfoPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [UserinfoPage]\n})\nexport class UserinfoPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3VzZXJpbmZvL3VzZXJpbmZvLnBhZ2Uuc2NzcyJ9 */\"","import { Component, OnInit } from '@angular/core';\nimport { DataService } from '../services/data.service';\nimport { LoadingService } from '../services/loading.service';\nimport { AlertController } from '@ionic/angular';\nimport { FirebaseService } from '../services/firebase.service';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport * as firebase from 'firebase';\n\n@Component({\n  selector: 'app-userinfo',\n  templateUrl: './userinfo.page.html',\n  styleUrls: ['./userinfo.page.scss'],\n})\nexport class UserinfoPage implements OnInit {\n\n\n  user: any;\n  userId: any;\n  friendRequests: any;\n  requestsSent: any;\n  friends: any;\n  alert: any;\n  // UserInfoPage\n  // This is the page where the user can view user information, and do appropriate actions based on their relation to the current logged in user.\n  constructor(\n    // public navCtrl: NavController,\n    // public navParams: NavParams,\n    private router: Router,\n    // public modalCtrl: ModalController,\n    public dataProvider: DataService,\n    public loadingProvider: LoadingService,\n    public alertCtrl: AlertController,\n    public firebaseProvider: FirebaseService,\n    private route: ActivatedRoute\n  ) { }\n\n  ngOnInit() {\n  }\n\n  ionViewDidEnter() {\n    // this.userId = this.navParams.get('userId');\n    this.userId = this.route.snapshot.params.id;\n    console.log(this.userId);\n    this.loadingProvider.show();\n    // Get user info.\n    this.dataProvider.getUser(this.userId).snapshotChanges().subscribe((user: any) => {\n      this.user = { $key: user.key, ...user.payload.data() };\n      console.log(this.user);\n      this.loadingProvider.hide();\n    });\n    // Get friends of current logged in user.\n    this.dataProvider.getUser(firebase.auth().currentUser.uid).snapshotChanges().subscribe((user: any) => {\n      if (user.payload.data() != null)\n        this.friends = user.payload.data().friends;\n    });\n    // Get requests of current logged in user.\n    this.dataProvider.getRequests(firebase.auth().currentUser.uid).snapshotChanges().subscribe(((requests: any) => {\n      console.log(requests.payload.data())\n      if (requests.payload.data() != null) {\n        this.friendRequests = requests.payload.data().friendRequests;\n        this.requestsSent = requests.payload.data().requestsSent;\n      }\n    }));\n  }\n\n  block() {\n    this.loadingProvider.show();\n    console.log(\"block function\");\n    firebase.database().ref('accounts/' + firebase.auth().currentUser.uid + '/conversations/' + this.userId).update({\n      blocked: true\n    }).then(() => {\n      this.loadingProvider.hide();\n      this.loadingProvider.showToast(\"User Blocked\");\n      this.router.navigateByUrl('/');\n    }).catch(() => {\n      this.loadingProvider.hide();\n      this.loadingProvider.showToast(\"Something went wrong\");\n    });\n\n  }\n\n  // Enlarge user's profile image.\n  enlargeImage(img) {\n    // let imageModal = this.modalCtrl.create(\"ImageModalPage\", { img: img });\n    // imageModal.present();\n  }\n\n  // Accept friend request.\n  acceptFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Confirm Friend Request',\n      message: 'Do you want to accept <b>' + this.user.name + '</b> as your friend?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Accept',\n          handler: () => {\n            this.firebaseProvider.acceptFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Deny friend request.\n  rejectFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Reject Friend Request',\n      message: 'Do you want to reject <b>' + this.user.name + '</b> as your friend?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Reject',\n          handler: () => {\n            this.firebaseProvider.deleteFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Cancel friend request sent.\n  cancelFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Friend Request Pending',\n      message: 'Do you want to delete your friend request to <b>' + this.user.name + '</b>?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Delete',\n          handler: () => {\n            this.firebaseProvider.cancelFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Send friend request.\n  sendFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Send Friend Request',\n      message: 'Do you want to send friend request to <b>' + this.user.name + '</b>?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Send',\n          handler: () => {\n            this.firebaseProvider.sendFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Open chat with this user.\n  sendMessage() {\n    this.router.navigateByUrl('/message/' + this.userId);\n    // this.navCtrl.push(MessagePage, { userId: this.userId });\n  }\n\n  // Check if user can be added, meaning user is not yet friends nor has sent/received any friend requests.\n  canAdd() {\n    if (this.friendRequests) {\n      if (this.friendRequests.indexOf(this.userId) > -1) {\n        return false;\n      }\n    }\n    if (this.requestsSent) {\n      if (this.requestsSent.indexOf(this.userId) > -1) {\n        return false;\n      }\n    }\n    if (this.friends) {\n      if (this.friends.indexOf(this.userId) > -1) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n}\n"],"sourceRoot":"webpack:///","file":"userinfo-userinfo-module-es5.js"}