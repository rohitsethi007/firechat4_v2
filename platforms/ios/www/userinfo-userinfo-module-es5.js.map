{"version":3,"sources":["webpack:///src/app/userinfo/userinfo.page.html","webpack:///src/app/userinfo/userinfo.module.ts","webpack:///src/app/userinfo/userinfo.page.scss","webpack:///src/app/userinfo/userinfo.page.ts"],"names":["routes","path","component","UserinfoPageModule","imports","forChild","declarations","UserinfoPage","router","modalCtrl","dataProvider","loadingProvider","alertCtrl","firebaseProvider","route","userId","snapshot","params","id","console","log","show","getUser","snapshotChanges","subscribe","user","$key","key","payload","data","hide","currentUser","uid","friends","getRequests","requests","friendRequests","requestsSent","ref","update","blocked","then","showToast","navigateByUrl","img","alert","create","header","message","name","buttons","text","handler","acceptFriendRequest","r","present","deleteFriendRequest","cancelFriendRequest","sendFriendRequest","indexOf","selector","template"],"mappings":"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","file":"userinfo-userinfo-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title *ngIf=\\\"user\\\">{{user.name}}</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <div *ngIf=\\\"user\\\">\\n    <ion-row padding> \\n    <div class=\\\"user-info\\\">\\n      <div class=\\\"user-img\\\">\\n        <img src=\\\"{{user.img}}\\\">\\n      </div>\\n\\n    <img src=\\\"{{user.img}}\\\" (click)=\\\"enlargeImage(user.img)\\\" onError=\\\"this.src='./assets/images/default-dp.png'\\\">\\n    <h4 style=\\\"margin:0\\\">{{user.name}}</h4>\\n    <p style=\\\"color:#aaa;margin:0\\\">@{{user.username}}</p>\\n    <p style=\\\"color:#444\\\">{{user.description}}</p>\\n    <div style=\\\"border-top: 1px solid #ececec; padding: 10px;\\\">\\n      <!-- Show actions based on the status of the user in relation to the current logged in user. -->\\n      <div *ngIf=\\\"friendRequests && friendRequests.indexOf(user.$key) > -1\\\">\\n        <p class=\\\"info\\\">Sent you a friend request.</p>\\n        <ion-button size=\\\"small\\\" (click)=\\\"rejectFriendRequest()\\\">\\n          Decline\\n        </ion-button>\\n        <ion-button size=\\\"small\\\" (click)=\\\"acceptFriendRequest()\\\">\\n          Accept\\n        </ion-button>\\n      </div>\\n      <div *ngIf=\\\"requestsSent && requestsSent.indexOf(user.$key) > -1\\\">\\n        <ion-button size=\\\"small\\\" (click)=\\\"cancelFriendRequest()\\\">Cancel\\n          Request</ion-button>\\n      </div>\\n      <div *ngIf=\\\"canAdd()\\\">\\n        <ion-button size=\\\"small\\\" (click)=\\\"sendFriendRequest()\\\">Add Friend</ion-button>\\n      </div>\\n      <div *ngIf=\\\"friends && friends.indexOf(user.$key) > -1\\\">\\n        <ion-button size=\\\"small\\\" (click)=\\\"sendMessage()\\\">Start Chat</ion-button>\\n        <ion-button size=\\\"small\\\" (click)=\\\"block()\\\">Block User</ion-button>\\n      </div>\\n    </div>\\n\\n\\n  </div>\\n  </ion-row>\\n  </div>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { UserinfoPage } from './userinfo.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserinfoPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [UserinfoPage]\n})\nexport class UserinfoPageModule {}\n","export default \":host {\\n  --page-margin: var(--app-narrow-margin);\\n  --page-background: var(--app-background);\\n}\\n\\n.user-info {\\n  margin: var(--page-margin) var(--page-margin) var(--page-margin) var(--page-margin);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdXNlcmluZm8vdXNlcmluZm8ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksdUNBQUE7RUFDQSx3Q0FBQTtBQUNKOztBQUVBO0VBQ0ksbUZBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL3VzZXJpbmZvL3VzZXJpbmZvLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHtcbiAgICAtLXBhZ2UtbWFyZ2luOiB2YXIoLS1hcHAtbmFycm93LW1hcmdpbik7XG4gICAgLS1wYWdlLWJhY2tncm91bmQ6IHZhcigtLWFwcC1iYWNrZ3JvdW5kKTtcbiAgfVxuXG4udXNlci1pbmZvIHtcbiAgICBtYXJnaW46IHZhcigtLXBhZ2UtbWFyZ2luKSB2YXIoLS1wYWdlLW1hcmdpbikgdmFyKC0tcGFnZS1tYXJnaW4pIHZhcigtLXBhZ2UtbWFyZ2luKTtcbiAgICAudXNlci1pbWcge1xuICBcbiAgICB9XG59Il19 */\";","import { Component, OnInit } from '@angular/core';\nimport { DataService } from '../services/data.service';\nimport { LoadingService } from '../services/loading.service';\nimport { AlertController, ModalController } from '@ionic/angular';\nimport { FirebaseService } from '../services/firebase.service';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport * as firebase from 'firebase';\n\n@Component({\n  selector: 'app-userinfo',\n  templateUrl: './userinfo.page.html',\n  styleUrls: ['./userinfo.page.scss'],\n})\nexport class UserinfoPage implements OnInit {\n\n\n  user: any;\n  userId: any;\n  friendRequests: any;\n  requestsSent: any;\n  friends: any;\n  alert: any;\n  // UserInfoPage\n  // This is the page where the user can view user information, and do appropriate actions based on their relation to the current logged in user.\n  constructor(\n    // public navCtrl: NavController,\n    // public navParams: NavParams,\n    private router: Router,\n    public modalCtrl: ModalController,\n    public dataProvider: DataService,\n    public loadingProvider: LoadingService,\n    public alertCtrl: AlertController,\n    public firebaseProvider: FirebaseService,\n    private route: ActivatedRoute\n  ) { }\n\n  ngOnInit() {\n  }\n\n  ionViewDidEnter() {\n    // this.userId = this.navParams.get('userId');\n    this.userId = this.route.snapshot.params.id;\n    console.log(this.userId);\n    this.loadingProvider.show();\n    // Get user info.\n    this.dataProvider.getUser(this.userId).snapshotChanges().subscribe((user: any) => {\n      this.user = { $key: user.key, ...user.payload.data() };\n      console.log(this.user);\n      this.loadingProvider.hide();\n    });\n    // Get friends of current logged in user.\n    this.dataProvider.getUser(firebase.auth().currentUser.uid).snapshotChanges().subscribe((user: any) => {\n      if (user.payload.data() != null)\n        this.friends = user.payload.data().friends;\n    });\n    // Get requests of current logged in user.\n    this.dataProvider.getRequests(firebase.auth().currentUser.uid).snapshotChanges().subscribe(((requests: any) => {\n      console.log(requests.payload.data())\n      if (requests.payload.data() != null) {\n        this.friendRequests = requests.payload.data().friendRequests;\n        this.requestsSent = requests.payload.data().requestsSent;\n      }\n    }));\n  }\n\n  block() {\n    this.loadingProvider.show();\n    console.log(\"block function\");\n    firebase.database().ref('accounts/' + firebase.auth().currentUser.uid + '/conversations/' + this.userId).update({\n      blocked: true\n    }).then(() => {\n      this.loadingProvider.hide();\n      this.loadingProvider.showToast(\"User Blocked\");\n      this.router.navigateByUrl('/');\n    }).catch(() => {\n      this.loadingProvider.hide();\n      this.loadingProvider.showToast(\"Something went wrong\");\n    });\n\n  }\n\n  // Enlarge user's profile image.\n  enlargeImage(img) {\n    // let imageModal = this.modalCtrl.create(\"ImageModalPage\", { img: img });\n    // imageModal.present();\n  }\n\n  // Accept friend request.\n  acceptFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Confirm Friend Request',\n      message: 'Do you want to accept <b>' + this.user.name + '</b> as your friend?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Accept',\n          handler: () => {\n            this.firebaseProvider.acceptFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Deny friend request.\n  rejectFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Reject Friend Request',\n      message: 'Do you want to reject <b>' + this.user.name + '</b> as your friend?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Reject',\n          handler: () => {\n            this.firebaseProvider.deleteFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Cancel friend request sent.\n  cancelFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Friend Request Pending',\n      message: 'Do you want to delete your friend request to <b>' + this.user.name + '</b>?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Delete',\n          handler: () => {\n            this.firebaseProvider.cancelFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Send friend request.\n  sendFriendRequest() {\n    this.alert = this.alertCtrl.create({\n      header: 'Send Friend Request',\n      message: 'Do you want to send friend request to <b>' + this.user.name + '</b>?',\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: data => { }\n        },\n        {\n          text: 'Send',\n          handler: () => {\n            this.firebaseProvider.sendFriendRequest(this.userId);\n          }\n        }\n      ]\n    }).then(r => r.present());\n  }\n\n  // Open chat with this user.\n  sendMessage() {\n    this.router.navigateByUrl('/message/' + this.userId);\n    // this.navCtrl.push(MessagePage, { userId: this.userId });\n  }\n\n  // Check if user can be added, meaning user is not yet friends nor has sent/received any friend requests.\n  canAdd() {\n    if (this.friendRequests) {\n      if (this.friendRequests.indexOf(this.userId) > -1) {\n        return false;\n      }\n    }\n    if (this.requestsSent) {\n      if (this.requestsSent.indexOf(this.userId) > -1) {\n        return false;\n      }\n    }\n    if (this.friends) {\n      if (this.friends.indexOf(this.userId) > -1) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n}\n"]}