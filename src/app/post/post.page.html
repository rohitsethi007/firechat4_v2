<ion-header>
  <ion-toolbar color="primary" >
    <ion-buttons color="primary" slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title class="title">{{title}}</ion-title>
  </ion-toolbar> 
</ion-header>

<ion-content fullscreen> 
<div class="listing-item">
 <ion-card *ngIf="post.type=='general'">
        <ion-card-header>
          <ion-row>
            <ion-col size=10>
          <ion-card-subtitle class="addedBy">
            <img class="addedByImg" src="{{post.avatar}}" onError="this.src='./assets/images/default-dp.png'" /> 
             <p><a class="addedByTitle" (click)="viewUser(post.addedByUser.addedByKey)" ><b>{{post.addedByUser.addedByUsername}}</b></a><!-- <img *ngIf="item.showNewIcon" class="newIcon" src="./assets/icon/new.svg" />  -->
              <br/>
             <span class="addedByDate">posted {{post.date.toDate() | DateFormat}}</span><br/>
            <a (click)="viewGroup(post.groupId)" class="addedByTitle">in <b>{{post.groupName}}</b></a></p>
          </ion-card-subtitle>
        </ion-col>
        <ion-col size=2>
          <ion-buttons>
            <ion-button (click)="showPostOptions(post)">
              <ion-icon slot="end" name="chevron-down-outline"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-col>
        </ion-row>
        </ion-card-header>
      <ion-card-content class="message">
        <div>
        <div *ngIf="post.postMedia">
          <ion-slides class="slider" pager="true" [options]="slideOptsOne" #slideWithNav>
          <ion-slide *ngFor="let s of post.postMedia">
            <div class="bgSizeContain" 
            [ngStyle]="{'background-image':'url('+s+')'}">
          </div>
          </ion-slide>
        </ion-slides>
        </div>

        <ion-label><b>{{post.title}}.</b> {{post.data.message}} <br/></ion-label>
      </div>
      <div class="tags-wrapper">
          <ion-row >
            <div class="tags" *ngFor="let tag of post.postTags">
              <span *ngIf="tag.isChecked" class="item-rating" [attr.ratingBase]="1">#{{tag.val}}</span>
              <span *ngIf="!tag.isChecked" class="item-rating" [attr.ratingBase]="0">#{{tag.val}}</span>
            </div>
          </ion-row>
        </div>
        <div class="reactions">
          <ion-row>
            <ion-col size=3>
              <ion-buttons>
                <ion-button (click)="submitReactionSmile()">
               <div *ngIf="post.showSmiley"><ion-icon size="small" class="icon" src="./assets/icon/smile-active.svg" ></ion-icon> <span class="text">Thanks</span></div> 
               <div *ngIf="!post.showSmiley"><ion-icon size="small" class="icon"  src="./assets/icon/smile.svg" ></ion-icon> <span class="text">Thanks</span></div> 
              </ion-button>
              </ion-buttons> 
            </ion-col>
            <ion-col size=3>
              <ion-buttons>
                <ion-button (click)="submitReactionHug()">
               <div *ngIf="post.showHug"><ion-icon size="small" class="icon" src="./assets/icon/hug-active.svg" ></ion-icon> <span class="text">Hug</span></div> 
               <div *ngIf="!post.showHug"><ion-icon size="small" class="icon"  src="./assets/icon/hug.svg" ></ion-icon> <span class="text">Hug</span></div> 
              </ion-button>
              </ion-buttons> 
            </ion-col>
            <ion-col size=2></ion-col>
            <ion-col size=2>
              <ion-buttons>
                <ion-button (click)="showReactionsList()">
              <div><ion-icon size="small" src="./assets/icon/smile-active.svg" class="icon"></ion-icon><ion-icon size="small" src="./assets/icon/hug-active.svg" class="icon"></ion-icon> <span class="text">{{post.totalReactionCount}}</span></div>
            </ion-button>
          </ion-buttons> 
            </ion-col>
            <ion-col size=2>
              <ion-buttons>
                <ion-button>
              <div><ion-icon size="small" class="icon" name="chatbox-outline"></ion-icon> <span class="text">{{post.totalReviewCount}}</span></div>
            </ion-button>
          </ion-buttons> 
          </ion-col>
          </ion-row>
        </div>
      </ion-card-content>
 <!-- <hr class="details-divider">
  
    <h3 class="detail-title">Selected Tags</h3> -->
  <hr class="details-divider">
  <div class="user-preferences-wrapper">
    <div  >
      <div class="reviews" *ngFor="let r of postReviews">
        <ion-row>
          <ion-col size="2">
              <img class="addedByImgReview" src="{{r.addedByUser.addedByImg}}" onError="this.src='./assets/images/default-dp.png'" />
          </ion-col>
          <ion-col class="review" size="9">
              <span class="addedByTitleReview"><a (click)="viewUser(r.addedByUser.addedByKey)" >
                <b>{{post.addedByUser.addedByUsername}}</b></a>, <span class="addedByDateReview">{{r.dateCreated.toDate() | DateFormat}}</span>
              </span>
                  <br/>
                  <br/>
                  <div *ngIf="r.reviewMedia.length > 0" class="bgSizeContain" 
                  [ngStyle]="{'background-image':'url('+r.reviewMedia+')'}"></div>
                  <div class="messageReview" [innerHTML]="r.review"></div>
            </ion-col>
      </ion-row>
     </div>
    </div>
  </div>

 </ion-card>

 <ion-card *ngIf="post.type=='event'">
  <ion-card-header>
    <ion-row>
      <ion-col size=10>
    <ion-card-subtitle class="addedBy">
      <img class="addedByImg" src="{{post.avatar}}" onError="this.src='./assets/images/default-dp.png'" /> 
       <p><a class="addedByTitle" (click)="viewUser(post.addedByUser.addedByKey)" ><b>{{post.addedByUser.addedByUsername}}</b></a><!-- <img *ngIf="item.showNewIcon" class="newIcon" src="./assets/icon/new.svg" />  -->
        <br/>
       <span class="addedByDate">posted {{post.date.toDate() | DateFormat}}</span><br/>
      <a (click)="viewGroup(post.groupId)" class="addedByTitle">in <b>{{post.groupName}}</b></a></p>
    </ion-card-subtitle>
  </ion-col>
  <ion-col size=2>
    <ion-buttons>
      <ion-button (click)="showPostOptions(post)">
        <ion-icon slot="end" name="chevron-down-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-col>
  </ion-row>
  </ion-card-header>
  <ion-card-content class="message">
    <div>
      <div *ngIf="post.postMedia">
        <ion-slides class="slider" pager="true" [options]="slideOptsOne" #slideWithNav>
        <ion-slide *ngFor="let s of post.postMedia">
          <div class="bgSizeContain" 
          [ngStyle]="{'background-image':'url('+s+')'}">
        </div>
        </ion-slide>
      </ion-slides>
      </div>
      <ion-label> <b>{{post.title}}.</b> <br/>{{post.data.eventDate}} at {{post.data.eventTime}}<br/><br/>
      {{post.data.address}}<br/><br/>
      {{post.data.link}}</ion-label>
    </div>
    <div class="tags-wrapper">
      <ion-row >
        <div class="tags" *ngFor="let tag of post.postTags">
          <span *ngIf="tag.isChecked" class="item-rating" [attr.ratingBase]="1">#{{tag.val}}</span>
          <span *ngIf="!tag.isChecked" class="item-rating" [attr.ratingBase]="0">#{{tag.val}}</span>
        </div>
      </ion-row>
    </div>
    <div class="reactions">
      <ion-row>
        <ion-col size=3>
          <ion-buttons>
            <ion-button (click)="submitReactionSmile()">
           <div *ngIf="post.showSmiley"><ion-icon size="small" class="icon" src="./assets/icon/smile-active.svg" ></ion-icon> <span class="text">Thanks</span></div> 
           <div *ngIf="!post.showSmiley"><ion-icon size="small" class="icon"  src="./assets/icon/smile.svg" ></ion-icon> <span class="text">Thanks</span></div> 
          </ion-button>
          </ion-buttons> 
        </ion-col>
        <ion-col size=3> 
          <ion-buttons>
            <ion-button (click)="submitReactionCheckin()">
           <div *ngIf="post.showCheckin"><ion-icon size="small" class="icon" src="./assets/icon/checkin-active.svg" ></ion-icon> <span class="text">Checkin</span></div> 
           <div *ngIf="!post.showCheckin"><ion-icon size="small" class="icon"  src="./assets/icon/checkin.svg" ></ion-icon> <span class="text">Checkin</span></div> 
          </ion-button>
          </ion-buttons> 
        </ion-col>
        <ion-col size=2></ion-col>
        <ion-col size=2>
          <ion-buttons>
            <ion-button (click)="showReactionsList()">
          <div><ion-icon size="small" src="./assets/icon/smile-active.svg" class="icon"></ion-icon><ion-icon size="small" src="./assets/icon/checkin-active.svg" class="icon"></ion-icon> <span class="text">{{post.totalReactionCount}}</span></div>
        </ion-button>
        </ion-buttons> 
        </ion-col>
        <ion-col size=2>
          <ion-buttons>
            <ion-button>
          <div><ion-icon size="small" class="icon" name="chatbox-outline"></ion-icon> <span class="text">{{post.totalReviewCount}}</span></div>
        </ion-button>
        </ion-buttons> 
        </ion-col>
      </ion-row>
    </div>
  </ion-card-content>

 <!-- <hr class="details-divider">
  
    <h3 class="detail-title">Selected Tags</h3> -->
    <hr class="details-divider">
    <div class="user-preferences-wrapper">
      <div  >
        <div class="reviews" *ngFor="let r of postReviews">
          <ion-row>
            <ion-col size="2">
                <img class="addedByImgReview" src="{{r.addedByUser.addedByImg}}" onError="this.src='./assets/images/default-dp.png'" />
            </ion-col>
            <ion-col class="review" size="9">
                <span class="addedByTitleReview"><a (click)="viewUser(r.addedByUser.addedByKey)" >
                  <b>{{post.addedByUser.addedByUsername}}</b></a>, <span class="addedByDateReview">{{r.dateCreated.toDate() | DateFormat}}</span>
                </span>
                    <br/>
                    <br/>
                    <div *ngIf="r.reviewMedia.length > 0" class="bgSizeContain" 
                    [ngStyle]="{'background-image':'url('+r.reviewMedia+')'}"></div>
                    <div class="messageReview" [innerHTML]="r.review"></div>
              </ion-col>
        </ion-row>
       </div>
      </div>
    </div>
</ion-card>

<ion-card *ngIf="post.type=='poll'">
  <ion-card-header>
    <ion-row>
      <ion-col size=10>
    <ion-card-subtitle class="addedBy">
      <img class="addedByImg" src="{{post.avatar}}" onError="this.src='./assets/images/default-dp.png'" /> 
       <p><a class="addedByTitle" (click)="viewUser(post.addedByUser.addedByKey)" ><b>{{post.addedByUser.addedByUsername}}</b></a><!-- <img *ngIf="item.showNewIcon" class="newIcon" src="./assets/icon/new.svg" />  -->
        <br/>
       <span class="addedByDate">posted {{post.date.toDate() | DateFormat}}</span><br/>
      <a (click)="viewGroup(post.groupId)" class="addedByTitle">in <b>{{post.groupName}}</b></a></p>
    </ion-card-subtitle>
  </ion-col>
  <ion-col size=2>
    <ion-buttons>
      <ion-button (click)="showPostOptions(post)">
        <ion-icon slot="end" name="chevron-down-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-col>
  </ion-row>
  </ion-card-header>
  <ion-card-content class="message">
    <div>
      <div *ngIf="post.postMedia">
        <ion-slides class="slider" pager="true" [options]="slideOptsOne" #slideWithNav>
        <ion-slide *ngFor="let s of post.postMedia">
          <div class="bgSizeContain" 
          [ngStyle]="{'background-image':'url('+s+')'}">
        </div>
        </ion-slide>
      </ion-slides>
      </div>
      <ion-label>         <b>{{post.title}}.</b>       </ion-label>
        <p class="sub-header" *ngIf="!voted && !pollClosed">* Please vote to see results</p>
        <form [formGroup]="pollOptionForm">
        <ion-list class="radio-list" lines="full" *ngIf="!voted && !pollClosed">
        <ion-radio-group class="radio-group" formControlName="selected_poll_option">
          <ion-item class="radio-item">
          <ion-label class="radio-label">{{post.data.pollOptions[0].name}}</ion-label>
          <ion-radio slot="start" color="secondary" value="0"></ion-radio>
          </ion-item>
          <ion-item class="radio-item">
          <ion-label class="radio-label">{{post.data.pollOptions[1].name}}</ion-label>
          <ion-radio slot="start" color="secondary" value="1"></ion-radio>
          </ion-item>
          <ion-item class="radio-item" *ngIf="post.data.pollOptions[2] != null">
          <ion-label class="radio-label">{{post.data.pollOptions[2].name}}</ion-label>
          <ion-radio slot="start" color="secondary" value="2"></ion-radio>
          </ion-item>
          <ion-item class="radio-item" *ngIf="post.data.pollOptions[3] != null">
          <ion-label class="radio-label">{{post.data.pollOptions[3].name}}</ion-label>
          <ion-radio slot="start" color="secondary" value="3"></ion-radio>
          </ion-item>
        </ion-radio-group>
        </ion-list>
        </form>

    </div>
    <div>
    <ion-button *ngIf="!voted && !pollClosed" class="submit-btn" type="submit" expand="block" (click)="vote()" fill="outline" [disabled]="!pollOptionForm.valid">Submit</ion-button>
    </div>
    <div class="canvas" *ngIf="voted || pollClosed">
    <!-- <canvas baseChart  [data]="chartData" [options]="chartOptions" [labels]="optionsArray" [chartType]="chartType"></canvas> -->
    <canvas baseChart 
    [datasets]="chartData" 
    [labels]="chartLabels" 
    [options]="chartOptions" 
    [colors]="chartColors"
    [legend]="showLegend" 
    [chartType]="chartType">
    </canvas>			  
    <div id="legend"></div>
    </div>
    <div class="tags-wrapper">
      <ion-row >
        <div class="tags" *ngFor="let tag of post.postTags">
          <span *ngIf="tag.isChecked" class="item-rating" [attr.ratingBase]="1">#{{tag.val}}</span>
          <span *ngIf="!tag.isChecked" class="item-rating" [attr.ratingBase]="0">#{{tag.val}}</span>
        </div>
      </ion-row>
    </div>
  </ion-card-content>
   <!-- <hr class="details-divider">
  
    <h3 class="detail-title">Selected Tags</h3> -->
    <hr class="details-divider">
    <div class="user-preferences-wrapper">
      <div>
        <div class="reviews" *ngFor="let r of postReviews">
          <ion-row>
            <ion-col size="2">
                <img class="addedByImgReview" src="{{r.addedByUser.addedByImg}}" onError="this.src='./assets/images/default-dp.png'" />
            </ion-col>
            <ion-col class="review" size="9">
                <span class="addedByTitleReview"><a (click)="viewUser(r.addedByUser.addedByKey)" >
                  <b>{{post.addedByUser.addedByUsername}}</b></a>, <span class="addedByDateReview">{{r.dateCreated.toDate() | DateFormat}}</span>
                </span>
                    <br/>
                    <br/>
                    <div *ngIf="r.reviewMedia.length > 0" class="bgSizeContain" 
                    [ngStyle]="{'background-image':'url('+r.reviewMedia+')'}"></div>
                    <div class="messageReview" [innerHTML]="r.review"></div>
              </ion-col>
        </ion-row>
       </div>
      </div>
    </div>
</ion-card>

<ion-card *ngIf="post.type=='resource'">
    <ion-card-header>
      <ion-row>
        <ion-col size=10>
      <ion-card-subtitle class="addedBy">
        <img class="addedByImg" src="{{post.avatar}}" onError="this.src='./assets/images/default-dp.png'" /> 
         <p><a class="addedByTitle" (click)="viewUser(post.addedByUser.addedByKey)" ><b>{{post.addedByUser.addedByUsername}}</b></a><!-- <img *ngIf="item.showNewIcon" class="newIcon" src="./assets/icon/new.svg" />  -->
          <br/>
         <span class="addedByDate">posted {{post.date.toDate() | DateFormat}}</span><br/>
        <a (click)="viewGroup(post.groupId)" class="addedByTitle">in <b>{{post.groupName}}</b></a></p>
      </ion-card-subtitle>
    </ion-col>
    <ion-col size=2>
      <ion-buttons>
        <ion-button (click)="showPostOptions(post)">
          <ion-icon slot="end" name="chevron-down-outline"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-col>
    </ion-row>
    </ion-card-header>
    <ion-card-content class="message">
      <div *ngIf="post.postMedia">
        <ion-slides class="slider" pager="true" [options]="slideOptsOne" #slideWithNav>
        <ion-slide *ngFor="let s of post.postMedia">
          <div class="bgSizeContain" 
          [ngStyle]="{'background-image':'url('+s+')'}">
        </div>
        </ion-slide>
      </ion-slides>
      </div>
      <ion-label>         <b>{{post.title}}.</b>       </ion-label>
      <div *ngIf="post.data.type == 'contact'" >
        {{post.data.name}}<br/>
        {{post.data.address}}<br/><br/>
        {{post.data.email}}<br/>
        {{post.data.phones}}<br/>
    </div>
    <div *ngIf="post.data.type == 'weblink'" >
      {{post.data.metatitle}}<br/>
      <img [src]="post.data.metaicon"/>   
       {{post.data.metadescription}}<br/><br/>
       <a href="{{post.data.metasite}}">{{post.data.metasite}}</a>
    </div>
    <div *ngIf="post.data.type == 'upload'" >
      <div *ngIf="post.data.uploadtype == 'location'" [innerHtml]="resource.url"></div>
      <div *ngIf="post.data.uploadtype == 'contact'">
        {{post.data.name}}<br/>
        {{post.data.address}}<br/>
        {{post.data.phones}}<br/>
        {{post.data.email}}<br/>
      </div>
      <div *ngIf="post.data.uploadtype == 'image'">
        <img src="{{post.data.resolvedurl}}" />
      </div>
      <div *ngIf="post.data.uploadtype == 'video'">
        <video controls width="100%" src="{{post.data.resolvedurl}}" ></video>
      </div>
    </div>
    <div class="tags-wrapper">
      <ion-row >
        <div class="tags" *ngFor="let tag of post.postTags">
          <span *ngIf="tag.isChecked" class="item-rating" [attr.ratingBase]="1">#{{tag.val}}</span>
          <span *ngIf="!tag.isChecked" class="item-rating" [attr.ratingBase]="0">#{{tag.val}}</span>
        </div>
      </ion-row>
    </div>
    <div class="reactions">
      <ion-row>
        <ion-col size=3>
          <ion-buttons>
            <ion-button (click)="submitReactionSmile()">
           <div *ngIf="post.showSmiley"><ion-icon size="small" class="icon" src="./assets/icon/smile-active.svg" ></ion-icon> <span class="text">Thanks</span></div> 
           <div *ngIf="!post.showSmiley"><ion-icon size="small" class="icon"  src="./assets/icon/smile.svg" ></ion-icon> <span class="text">Thanks</span></div> 
          </ion-button>
          </ion-buttons> 
        </ion-col>
        <ion-col size=3>
          <ion-buttons>
            <ion-button (click)="submitReactionBookmark()">
           <div *ngIf="post.showBookmark"><ion-icon size="small" class="icon" src="./assets/icon/bookmark-active.svg" ></ion-icon> <span class="text">Bookmark</span></div> 
           <div *ngIf="!post.showBookmark"><ion-icon size="small" class="icon"  src="./assets/icon/bookmark.svg" ></ion-icon> <span class="text">Bookmark</span></div> 
          </ion-button>
          </ion-buttons> 
        </ion-col>
        <ion-col size=2></ion-col>
        <ion-col size=2>
          <ion-buttons>
            <ion-button (click)="showReactionsList()">
          <div><ion-icon size="small" src="./assets/icon/bookmark-active.svg" class="icon"></ion-icon><ion-icon size="small" src="./assets/icon/smile-active.svg" class="icon"></ion-icon><span class="text">{{post.totalReactionCount}}</span></div>
        </ion-button>
      </ion-buttons> 
        </ion-col>
        <ion-col size=2>
          <ion-buttons>
            <ion-button>
             <div><ion-icon size="small" class="icon" name="chatbox-outline"></ion-icon> <span class="text">{{post.totalReviewCount}}</span></div>
           </ion-button>
      </ion-buttons> 
        </ion-col>
      </ion-row>
    </div>
    </ion-card-content>
 <!-- <hr class="details-divider">
  
    <h3 class="detail-title">Selected Tags</h3> -->
    <hr class="details-divider">
    <div class="user-preferences-wrapper">
      <div  >
        <div class="reviews" *ngFor="let r of postReviews">
          <ion-row>
            <ion-col size="2">
                <img class="addedByImgReview" src="{{r.addedByUser.addedByImg}}" onError="this.src='./assets/images/default-dp.png'" />
            </ion-col>
            <ion-col class="review" size="9">
                <span class="addedByTitleReview"><a (click)="viewUser(r.addedByUser.addedByKey)" >
                  <b>{{post.addedByUser.addedByUsername}}</b></a>, <span class="addedByDateReview">{{r.dateCreated.toDate() | DateFormat}}</span>
                </span>
                    <br/>
                    <br/>
                    <div *ngIf="r.reviewMedia.length > 0" class="bgSizeContain" 
                    [ngStyle]="{'background-image':'url('+r.reviewMedia+')'}"></div>
                    <div class="messageReview" [innerHTML]="r.review"></div>
              </ion-col>
        </ion-row>
       </div>
      </div>
    </div>
</ion-card>
</div>
</ion-content>
<ion-footer>
  <ion-toolbar>
    <ion-row lines="none" class="uploads item-text-wrap" *ngIf="reviewMedia && reviewMedia.length > 0">
      <div class="img-wrap" *ngFor="let media of reviewMedia">
          <ion-thumbnail slot="start">
            <span class="close" (click)="removeMedia(media)">&times;</span>
            <ion-img [src]="media"></ion-img>
          </ion-thumbnail>
        </div>
    </ion-row>
    <ion-item>
      <ion-button fill="clear" (click)="attach()" [disabled]="reviewMedia.length >= 1">
        <ion-icon size="large" name="camera-outline"></ion-icon>
      </ion-button>
      <ion-textarea class="comment" rows="0" placeholder="Type your message" [(ngModel)]="message"></ion-textarea>
       <ion-buttons slot="end">
        <ion-button fill="clear" (click)="submitReply()" [disabled]="!message && !uploadingImage">
          <ion-icon size="large" color="secondary" name="arrow-forward-circle"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-item>
  </ion-toolbar>
</ion-footer>

