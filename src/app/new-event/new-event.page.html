<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>{{title}}</ion-title>
    <ion-buttons *ngIf="step==2" slot="end">
      <ion-button color="secondary" class="ion-text-capitalize" [disabled]="!eventForm.valid" (click)="submitEventForm()">Post</ion-button>
    </ion-buttons>
</ion-toolbar>
</ion-header> 

<ion-content  class="forms-validations-content">
  <div *ngIf="step==1"> 
    <div *ngIf="groups && groups.length > 0">
      <ion-list>
        <ion-item text-wrap *ngFor="let group of groups" (click)="selectGroup(group.$key)">
          <ion-thumbnail slot="start">
            <img src="{{group.img}}" onError="this.src='./assets/images/default-group.png'">
          </ion-thumbnail>
          <ion-label>
              <b>{{group.name}}</b><br/>
              {{group.description}}
          </ion-label>
        </ion-item>
      </ion-list>
    </div>
  </div>
  <div *ngIf="step==2">
  <form class="validations-form" [formGroup]="eventForm" (ngSubmit)="submitEventForm()">
    <ion-list class="inputs-list" lines="full">
      <ion-list-header class="header">
        posting in &nbsp;<ion-label><b>{{group.name}}</b></ion-label>
      </ion-list-header>
      <ion-item class="input-item">
        <ion-input type="text" formControlName="title" clearInput placeholder="Enter a short description"></ion-input>
      </ion-item>
      <ion-item class="input-item">
        <ion-label position="floating">Event Date:</ion-label>
        <ion-datetime formControlName="eventDate" value="{minEventYear}-{minEventMonth}-{minEventDay}" [min]="minDate" [max]="maxEventYear"
        [dayShortNames]="customDayShortNames"
        displayFormat="DDD. MMM DD, YYYY"
        monthShortNames="January, February, March, April, May, June, July, August, September, October, November, December"></ion-datetime>
        </ion-item>
      <ion-item class="input-item">
        <ion-label position="floating">Event Time:</ion-label>
        <ion-datetime  formControlName="eventTime" displayFormat="h:mm A" minuteValues="0,15,30,45"></ion-datetime>
      </ion-item>
      <ion-item class="input-item">
        <ion-textarea rows="6"  formControlName="address" clearInput placeholder="Enter the full address of the event"></ion-textarea>
      </ion-item>
      <ion-item class="input-item">
        <ion-input type="text" formControlName="weblink" clearInput placeholder="Paste or type the link" (focusout)="linkFocusOut()"></ion-input>
      </ion-item> 
      <ion-item class="input-item">
        <ion-textarea rows="6"   [(ngModel)]="linkDescription" name="linkDescription" formControlName="description" clearInput placeholder="Enter the details of the event"></ion-textarea>
      </ion-item>
      <ion-item>
        <ion-label>I'll be attending the Event.</ion-label>
        <ion-checkbox formControlName="eventAttending" checked="false"  color="primary"></ion-checkbox>
      </ion-item>
    </ion-list>
    <ion-list class="inputs-list" lines="full">
      <ion-list-header>
        <ion-label class="header-title">Select relevant tags</ion-label>
      </ion-list-header>
 
      <div class="reviews-wrapper">
      <ion-row>
        <div class="tags" formArrayName="tags" *ngFor="let entry of eventForm.controls.tags.controls; let i = index">
          <ion-label *ngIf="postTags[i] === undefined || !postTags[i].isChecked" class="item-rating" [attr.ratingBase]="0">{{postTags[i].val}}</ion-label>
          <ion-label *ngIf="postTags[i] !== undefined && postTags[i].isChecked" class="item-rating" [attr.ratingBase]="1">{{postTags[i].val}}</ion-label>  
          <ion-checkbox slot="start" [formControlName]="i" [(ngModel)]="postTags[i].isChecked"></ion-checkbox>
        </div>
      </ion-row>

      <div class="error-container">
        <ng-container *ngFor="let validation of validations.tags">
          <div class="error-message" *ngIf="eventForm.get('tags').hasError(validation.type) && (eventForm.get('tags').dirty || eventForm.get('tags').touched)">
            <ion-icon name="information-circle-outline"></ion-icon>
            <span>{{ validation.message }}</span>
          </div>
        </ng-container>
      </div>
      </div>
    </ion-list>

    <!-- <ion-button class="submit-btn" type="submit" expand="block" fill="outline" [disabled]="!eventForm.valid">Submit</ion-button> -->

  </form>
  </div>

</ion-content>
<ion-footer *ngIf="step==2">
  <ion-toolbar>
    <ion-row lines="none" class="uploads item-text-wrap" *ngIf="postMedia && postMedia.length > 0">
      <div class="img-wrap" *ngFor="let media of postMedia">
          <ion-thumbnail slot="start">
            <span class="close" (click)="removeMedia(media)">&times;</span>
            <ion-img [src]="media">
              <!-- <ion-buttons class=""> 
                <ion-button (click)="removeMedia()">
                  <ion-icon size="small" name="close-circle-outline"></ion-icon>
                </ion-button>
              </ion-buttons> -->
            </ion-img>
          </ion-thumbnail>
        </div>
    </ion-row>
    <ion-item lines="none">
      <ion-button class="ion-text-capitalize" fill="clear" (click)="attach()">
        <ion-icon class="ion-padding-end" size="large" name="camera-outline"></ion-icon>
        Add photo or video
      </ion-button>
    </ion-item>
  </ion-toolbar>
</ion-footer>
